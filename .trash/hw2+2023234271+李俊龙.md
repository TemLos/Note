1.
a) The delay don't change

b) The delay becomes a quarter of the origin

c) The delay becomes a half of the origin

d) The delay becomes a half of the origin


2.
Consider $V_i$ and $i_i$ as the voltage and current of the $C_i$
Use KVL, we have
$$
\begin{align}
V_5&=V_{in}-R_1(I_1+I_2+I_3+I_4+I_5)-R_1(I_3+I_4+I_5)-R_5I_50\\
&=V_{in}-R_1(C_1\frac{\mathrm dV_1}{\mathrm dt}+C_2\frac{\mathrm dV_2}{\mathrm dt}+C_3\frac{\mathrm dV_3}{\mathrm dt}+C_4\frac{\mathrm dV_4}{\mathrm dt}+C_5\frac{\mathrm dV_5}{\mathrm dt})\\
&\qquad\quad -R_3(C_3\frac{\mathrm dV_3}{\mathrm dt}+C_4\frac{\mathrm dV_4}{\mathrm dt}+C_5\frac{\mathrm dV_5}{\mathrm dt})\\
&\qquad\quad -R_5C_5\frac{\mathrm dV_5}{\mathrm dt}\\
&=V_{in }(1-e^{-\frac{t}{\tau}})
\end{align}
$$
$$
\begin{align}
\tau = &R_1(C_1+C_2+C_3+C_4+C_5)+\\
&R_3(C_3+C_4+C_5)+\\
&R_5C_5
\end{align}
$$

3.
a)
From In to Out1
$$
\begin{align}
R(C+2C+2C+C+C+3C)
+2R(2C+2C)
+R\cdot2C
=20RC
\end{align}
$$
From in to Out2
$$
\begin{align}
R(C+2C+2C+C+C+3C)
+R(C+C+3C)
+R(C+3C)
+R\cdot3C\\
=22RC
\end{align}
$$
Apperently, In to Out2 is critical path.

b)
The equivalent R-C circuit after t=T1 is showin below:

![|500](_image/hw2_1.jpg)

$$
\begin{align}
R_1&=R_{eqPMOS}&=20000\ \Omega\\
R_2&=\frac{R_{eqPMOS}}{3}&=6667\ \Omega\\
R_3&=\frac{R_{eqPMOS}}{2}&=10000\ \Omega\\
R_4&=\frac{R_{eqNMOS}}{2}&=5000\ \Omega\\
R_5&=\frac{R_{eqNMOS}}{2}&=5000\ \Omega\\
R_6&=\frac{R_{eqPMOS}}{2}&=10000\ \Omega\\
\end{align}
$$
$$
\begin{align}
C_1&=6(C_{gs}+C_{db})+5f\ F&= 14f\ F\\
C_2&=3(C_{gs}+C_{db})+20f\ F&=65f\ F\\
C_3&=4(C_{gs}+C_{db})+10f\ F&=326f\ F\\
C_4&=4(C_{gs}+C_{db})+5f\ F&=321f\ F\\
C_5&=4(C_{gs}+C_{db})+20f\ F&=336f\ F\\
\end{align}
$$

c) 
$$
\begin{align}
V_5&=V_{in}-R_1(I_1+I_2+I_3+I_4+I_5)-R_3(I_3+I_4+I_5)-R_5(I_4+I_5)\\
&=V_{in}(1-e^{t/\tau})
\end{align}
$$
$$
\begin{align}
\tau=&R_1(C_1+C_2+C_3+C_4+C_5)\\
&+R_3(C_3+C_4+C_5)\\
&+R_5(C_4+C_5)\\
=&34.335\ ns
\end{align}
$$
$$
t=0.69\tau=34.335\ ns
$$

4.
a)
The equivalent R-C circuit after t=T1 is showin below:
![|475](_image/hw2+2023234271+李俊龙_image_2.jpg)

For single element:
$$
t_{p0}=\frac{R}{S}[SC_{iref}+\frac{SC_{iref}}{r_w}+c_w\frac{L}{N}]+r_w\frac{L}{N}[c_w\frac{L}{2N}+\frac{SC_{iref}}{r_w}]
$$
The total Elmore delay expression is 
$$
\begin{align}
t_p=Nt_{p0}&=N\frac{R}{S}[SC_{iref}+\frac{SC_{iref}}{r_w}+c_w\frac{L}{N}]+Nr_w\frac{L}{N}[c_w\frac{L}{2N}+\frac{SC_{iref}}{r_w}]\\
&=RC[N+\frac{N}{r_w}+\frac{c_wL}{SC_{iref}}]+r_wc_w[\frac{L^2}{2N}+\frac{SC_{iref}L}{r_wc_w}]
\end{align}
$$
b)

$$
\begin{cases}
t'_{pn}=RC[1+\frac{1}{r_w}]-\frac{r_wc_wL^2}{2N^2}=0\\
t'_{ps}=-\frac{Rc_wL}{S^2}+C_{iref}L=0
\end{cases}
$$

$$
\begin{cases}
N=\sqrt{\frac{r_wc_wL^2}{2RC_{iref}(1+\frac{1}{r_w})}}\\
S=\sqrt{\frac{Rc_w}{C_{iref}}}
\end{cases}
$$
Finally, the two variables can be rounded up.


5.
a) 
Firstly, we calculate $I_{av}=I{ds}$ (|V_{ds}|=|V_{gs}|=supply voltage, which means $I_{ds}=I_{dsat}$)
For conventional inverter, $V_{DS}=V_{GS}\gt V_{dsat}$ , ignoring CLM, we have
$$
\begin{align}
I_{av1}&=-K'\frac{W}{L}(V_{GS}-V_T-\frac{V_{min}}{2})V_{min}\\
&=-\frac{1}{2}K'\frac{W}{L}(V_{GS}-V_T)^2\\
&=-\frac{1}{2}K'\frac{W}{L}(-V_{DD}-V_{T0})^2\\
\end{align}
$$
For new inverter, $V_{DS}=V_{GS},\quad V_{SB}=V_{dd\_new}$
$$
\begin{align}
I_{av2}&=-K'\frac{W}{L}(V_{GS}-V_T-\frac{V_{min}}{2})V_{min}\\
&=-\frac{1}{2}K'\frac{W}{L}(V_{GS}-V_T)^2\\
&=-\frac{1}{2}K'\frac{W}{L}(-V_{DD_\_new}-V_{T0}-\gamma V_{DD_\_new})^2\\
\end{align}
$$
To make sure the delay stays the same
$$
\frac{C_LV_{DD}}{I_{av1}}=\frac{C_LV_{DD\_new}}{I_{av2}}
$$
that is
$$
\frac{C_LV_{DD}}{-\frac{1}{2}K'\frac{W}{L}(-V_{DD}-V_{T0})^2}=\frac{C_LV_{DD\_new}}{-\frac{1}{2}K'\frac{W}{L}(-V_{DD_\_new}-V_{T0}-\gamma V_{DD_\_new})^2}
$$
$$
\frac{V_{DD}}{((-V_{DD}-V_{T0})^2)^2}=\frac{V_{DD\_new}}{(-V_{DD_\_new}-V_{T0}-\gamma V_{DD_\_new})^2}
$$
$$
\frac{0.5}{0.09}=\frac{V_{DD\_new}}{(-1.1V_{DD\_new}+0.2)^2}
$$
$$
V_{DD\_new1}=0.0757\ V(discard)\quad V_{DD\_new2}=0.4367\ V
$$
b) With $|V_{SB}|$ increasing, $|V_T|$ decrease, so the operating of voltage decrease.

6.
a) when the capacitor is discharged, $V_{OL}=0$
$$
\begin{align}
I_{OL}&=K'\frac{W}{L}(V_{GS}-V_T-\frac{V_{DSAT}}{2})V_{DSAT}(1+\lambda V_{DS})\\
&=K'\frac{W}{L}(V_{DD}-V_{T0}-\frac{V_{DSAT}}{2})V_{DSAT}(1+\lambda V_{DD})\\
&=115\times 10^{-6}\times(2.5-0.43-0.63/2)\times 0.63\times(1+0.06*2.5)\\
&=1.4622\ mA
\end{align}
$$
When the capacitor is chatged, $V_{SB}=V_{OH},\ V_{GS}=V_T$
$$
\begin{align}
V_{GS}=V_{DS}&=V_{DD}-V_{OH}\\
&=V_{T0}+\gamma(\sqrt{\Phi_S+V_{SB}}-\sqrt{\Phi_S})\\
&=V_{T0}+\gamma(\sqrt{\Phi_S+V_{OH}}-\sqrt{\Phi_S})\\
\end{align}
$$
So $V_{OH}=1.7647\ V$, and $I_{OH}=0 \ A$ due to $V_{GS}=V_T$
$$
t=\frac{C_L\Delta V}{I_{av}}=\frac{1.7647\times 5\times 10^{-12}}{\frac{1.4622\times 10^{-3}}{2}}=2.4138\ ns
$$
b)
$$
t_{HL}=0.69RC=17.25\ ns
$$
c)
$$
E_C=\int VC_L\frac{\mathrm dV}{\mathrm dt}\mathrm dt=\int^{V_{OH}}_{V_{OL}}VC_L\mathrm dV=\frac{1}{2}
C_LV^2_{OH}=7.7854\times 10^{-12}\ J$$


Charging:
$$
E=\int V_{DD}C_L\frac{\mathrm dV}{\mathrm dt}\mathrm dt=\int^{V_{OH}}_{V_{OL}}V_{DD}C_L\mathrm dV=\frac{1}{2}
C_LV_{DD}V_{OH}=11.029\times 10^{-12}\ J$$
$$
E_{M1}=E-E_C=3.244\times 19^{-12}\ J
$$
Discharging:
$$
E_{M1,R=5k\Omega}=E_{M1,R=1k\Omega}=E_C=7.7854\times 10^{-12}\ J
$$
d)
YES. 
On one hand, after replacing the NMOS by PMOS, there is no body effect which improve the threshold voltage, on the other hand, PMOS brings samller resistance which 'll decrease the time factor. 


7.
a)
$$
E_{heat}=E-E_C=\int^{V_{DD}}_0(V_{DD}-V)C_L\mathrm dV=\frac{1}{2}V_{DD}^2C_L
$$
b)
The energy dissipated is independant on resistance, so $E_{heat}$ stays the same.

c)
$0\rightarrow \frac{V_{DD}}{2}$
$$
E_h=\frac{1}{2}C_L\frac{V^2_{DD}}{4}
$$
$\frac{V_{DD}}{2}\rightarrow V_{DD}$
$$
E_h=\frac{1}{2}C_L(V^2_{DD}-\frac{V^2_{DD}}{4})=\frac{3}{8}C_LV_{DD}^2
$$


8.
a)
i:0.9 V
ii:1.2 V
iii:0.9 V
iv:1.2 V
v:0.9 V
vi:0.3 V
vii:0 V

b)
$$
E_C=\int^{0.6}_0VC_L\mathrm dV=1.8\times 10^{-15}\ J
$$

c)
$0\rightarrow 1, \ V_{out1}=1.2V$
$$
\int^{V_{out1}}_0VC_L\mathrm dV=\frac{1}{2}C_LV^2_{Out1}=7.2\times 10^{-15}\ J
$$
$1\rightarrow 0,\ V_{out}=0.3V$
$$
\int^{V_{out1}}_{V_{Out2}}VC_L\mathrm dV=\frac{1}{2}C_L(V^2_{Out1}-V^2_{Out2})=6.75\times 10^{-15}\ J
$$